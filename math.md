---
marp: true
paginate: true
footer: '機械学習のための関数解析学の基礎の基礎'
theme : "white"
transition : "none"
---

# 機械学習のための関数解析学の基礎の基礎

2020-09-10

---

## 目的
- 関数解析学の基礎（とくに，ヒルベルト空間）をまとめる
- 機械学習への応用を見据え，見通しよく理解することを目的とする
- 集合・位相，線形代数，微分積分（とくに，ルベーグ積分）の基本的な内容は既知であると仮定する

---

## 記号の約束
- [Def]は定義，[Thm]は定理，[N.B.]は注意を表す．
- $\mathbb{N}$は自然数全体の集合，$\mathbb{Q}$は有理数全体の集合，$\mathbb{R}$は実数全体の集合，$\mathbb{C}$は複素数全体の集合を表す．
- $V$をベクトル空間とする．
- ノルムが定義された$V$をノルム空間$X$とする．
- $\mathcal{H}$をヒルベルト空間とする．

---

## 内積

**[Def]** 内積
実ベクトル空間$V$の任意の2元$f,g$に対して，1つの実数を対応させる関数$\langle f,g \rangle$が次の条件を満たすとき，関数$\langle \cdot, \cdot \rangle: V \times V \rightarrow \mathbb{R}$を内積と定義する．
ここで，$f,g,h \in V$，$a,b \in \mathbb{R}$．
1. $\langle g, f \rangle = \langle f, g \rangle$
1. $\langle af+bg, h \rangle = a\langle f, h \rangle + b\langle g, h \rangle$
1. $\langle f, f \rangle \geq 0$かつ等号が成立するのは$f=0$の場合に限る

[N.B.]
複素ベクトル空間を考える場合，$\mathbb{C}$になおしたり適当に複素共役をとったりしてください．

---

## 内積空間

内積が定義されたベクトル空間を内積空間という．
内積空間にはノルムを定義することができる．
内積空間の任意の元$f$に対して
$$
\|f\| = \sqrt{\langle f, f \rangle}
$$
と定義するとき，これを内積から自然に導かれるノルムという．
内積空間は$\|f\|$に関してノルム空間になり，このノルムに関して距離空間になる．

---

## ヒルベルト空間
**[Def]** ヒルベルト空間
完備な内積空間をヒルベルト空間$\mathcal{H}$という．

[N.B]
このスライドでは，ヒルベルト空間のうち可分なもののみを対象として考える．
可分でないヒルベルト空間は，量子論で扱う対象に必要な場合があるそうです．詳しくは知りません．

---

## 部分空間
**[Def]** 部分空間
$S$を$V$の部分集合とする．$S$が$V$の中の演算に関して再びベクトル空間になっているとき，$S$を$V$の部分空間という．
1. $S$の任意の2元の和が$S$に属する
2. $S$の任意の$a \in \mathbb{R}(または\mathbb{C})$倍が$S$に属する

---

## 直交と直交補空間
**[Def]** 直交
$\mathcal{H}$の各元にたいする直交性：
$\mathcal{H}$の元$f,g$に対して$\langle f, g \rangle=0$が成立するとき，$f$と$g$は直交しているという．

$\mathcal{H}$の部分集合に対する直交性：
$S,G$を$\mathcal{H}$の部分集合とする．$f\in \mathcal{H}$が$S$に属するすべての元と直交しているとき，$f$は$S$と直交するという．$S$の任意の元が$G$と直交するとき，「$S$と$G$は直交する」という．

**[Def]** 直交補空間
$S$に直交する元の全体の集合を$S^\perp$で表し，$S$の直交補空間という．$S^\perp$は$\mathcal{H}$の閉部分空間になる．

---
## 直交展開

---

## 有界線形汎関数


---

## （内積空間における）ハーン・バナッハの拡張定理

**[Thm]**
$X$を内積空間とし，$M$を$X$の部分空間とする．$g:M \rightarrow \mathbb{R}$が$M$上の有界線形汎関数であるとき，$X$上の有界線形汎関数$f:M \rightarrow \mathbb{R}$で次の条件を満たすものが存在する．
1. $f(x)=g(x) (\forall x \in M)$
1. $$\|f\| \coloneqq \sup_{x\in X \setminus \{0\}} \frac{|f(x)|}{\|x\|_X}=\|g\| \coloneqq \sup_{x \in M \setminus \{0\}} \frac{|g(x)|}{\|x\|_X} < \infty$$
1.の条件が成り立つとき，「$f$は$g$の拡張」または「$g$は$f$の$M$への制限」という．
 ここで，$\| \cdot \|$は有界線形汎関数のノルム，$\| \cdot \|_X$は$X$上に定義された内積から自然に導かれるノルムである．

---
## （内積空間における）ハーン・バナッハの拡張定理の証明

**[Prf.]**
$g$に対して，$M$のコーシー列$\{ z_n\}^\infty_{n=1}$が存在し，
$$g(x) = \lim_{n \rightarrow \infty} \langle x, z_n \rangle \qquad (\forall x \in M)$$
$$\|g\| = \lim_{n \rightarrow \infty} \|z_n\|_M \qquad (\|z\|_M = \|z\|_X, \forall z \in M)$$
と表せる．$\{ z_n\}^\infty_{n=1}$は$X$のコーシー列でもあるから
$$f(x) \coloneqq \lim_{n \rightarrow \infty} \langle x,z_n \rangle \qquad (\forall x \in X)$$
によって有界線形汎関数$f$を定義することができ，明らかに1.を満たす．
また，以下により2.も満たすことがわかる．
$$\|f \| = \lim_{n \rightarrow \infty}\|z_n\|_X = \lim_{n \rightarrow \infty}\|z_n\|_M = \|g\|$$

---

## リースの表現定理
**[Thm]**

---

## ニューラルネットワークの普遍性定理

[Cybenko, George. "Approximation by superpositions of a sigmoidal function." Mathematics of control, signals and systems 2.4 (1989): 303-314.][cybenko]

**[Def]** sigmoidal関数
関数$\sigma:\mathbb{R} \rightarrow \mathbb{R}$が次の条件をみたすとき，sigmoidal関数と定義する．

$$
  \sigma \rightarrow
    \begin{cases}
      1 & (t \rightarrow +\infty) \\
      0 & (t \rightarrow -\infty)
    \end{cases}
$$

---

## ニューラルネットワークの普遍性定理

**[Thm]** 普遍性定理
$\sigma:\mathbb{R} \rightarrow \mathbb{R}$を連続なsigmoidal関数とすると，
$$
  G(x) = \sum^N_{j=1} \alpha_j \sigma(\langle x,y_j \rangle + \theta_j)
$$
という形をした$X$上の関数全体の集合は，$X$上の実数値連続関数全体の集合$C(X)$で稠密になる．
すなわち，任意の$f \in C(X)$と任意の正数$\epsilon$に対して，上の形で表現される関数$G$を適当にとれば，
$$ \forall x \in X,|f(x)-G(x)|< \epsilon $$
が成立する．ここで$\alpha_j \in \mathbb{R}$，$y_j \in \mathbb{R}^n$であり，$\langle x,y \rangle$は内積である．

---

## ニューラルネットワークの普遍性定理
[鈴木先生のスライド][taiji2]より概説を引用
sigmoidalな関数のスケールを適切に選べば，階段関数をいくらでも精度良く近似することができる．

階段関数を近似することができれば，それらを足し合わせることで，三角関数をいくらでも精度良く近似することができる．

---
## ニューラルネットワークの普遍性定理
[鈴木先生のスライド][taiji2]より概説を引用

三角関数を近似することができれば，それらを足し合わせることで，任意の連続関数をいくらでも精度良く近似することができる．

すなわち，
「3層ニューラルネットワークの中間層のノードを十分な数用意すれば，任意の連続関数をいくらでも精度良く近似することができる．」

---

## ガウス過程回帰

---


## 再生核ヒルベルト空間（RKHS）

---

## 再生核の定義

---

## RKHSにおけるガウス過程回帰の理解

---

## 参考資料
- [「集合と位相」をなぜ学ぶのか ― 数学の基礎として根づくまでの歴史　(藤田博司)][fujita]
- [固有値問題30講　(志賀浩二)][shiga1]
- [ルベーグ積分30講　(志賀浩二)][shiga2]
- [測度・確率・ルベーグ積分　応用への最短コース　(原啓介)][hara]
- [工学のための関数解析　(山田功)][yamada]
- [工学系の関数解析　(小川英光)][ogawa]
- [深層学習の数理　大阪大学集中講義　(鈴木大慈)][taiji1]
- [深層学習の数理：カーネル法，スパース推定との接点　(鈴木大慈)][taiji2]

[cybenko]:https://link.springer.com/article/10.1007/BF02551274
[fujita]:https://gihyo.jp/book/2018/978-4-7741-9612-1
[shiga1]:https://www.asakura.co.jp/books/isbn/978-4-254-11485-0/
[shiga2]:https://www.asakura.co.jp/books/isbn/978-4-254-11484-3/
[hara]:https://bookclub.kodansha.co.jp/product?item=0000149472
[yamada]:https://www.saiensu.co.jp/search/?isbn=978-4-901683-62-3&y=2009
[ogawa]:https://www.morikita.co.jp/books/book/445
[taiji1]:https://www.slideshare.net/trinmu/ss-161240890
[taiji2]:https://www.slideshare.net/trinmu/ss-237399755

---
## Appendix
**[Def]** ベクトル空間
集合$V$の任意の2元$f,g$と，任意の$a \in \mathbb{R}(または\mathbb{C})$に対し，和$f \oplus g\in V$と積$a*f \in V$が定義され，次の条件を満たしているとき，$V$をベクトル空間という．
1. $(f \oplus g) \oplus h = f \oplus (g \oplus h)$
1. 任意の$f \in V$に対して$f \oplus 0=f$となる元$0 \in V$が存在
1. 各元$f \in V$に対して，$f \oplus f'=0$となる元$f' \in V$が存在
1. $(ab)*f = a*(b*f)$
1. $1*f = f$
1. $a*(f \oplus g)=(a*f) \oplus (b*g)$
1. $(a+b)*f=(a*f) \oplus (b*g)$
混乱の恐れがないとき，$f \oplus g$を$f+g$で表し，$a*f$を$af$で表す．

---

**[Def]** 完備
ノルム空間$X$の点列$\{ x_n \} (n=1,2, \dots)$が$\|x_n -y\| \rightarrow 0 \  (n \rightarrow \infty)$を満たすとき，$\lim_{n \rightarrow \infty}x_n=y$ と表す．
点列$\{ x_n \} (n=1,2, \dots)$が
$$
\| x_m - x_n \| \rightarrow 0 \quad (m,n \rightarrow \infty)
$$
を満たすときコーシー列という．
『$X$の任意の点列に収束先が存在』$\Rightarrow$『$X$の任意のコーシー列が$X$の点に収束』
は自明
『$X$の任意のコーシー列が$X$の点に収束』$\Rightarrow$『$X$の任意の点列に収束先が存在』
は一般に成り立たない．
下が成り立つ空間を完備な空間という．
完備なノルム空間をバナッハ空間$\mathcal{B}$という．

---

**[Def]** 可分
ヒルベルト空間$\mathcal{H}$に，高々可算かつ稠密な部分集合が存在するとき，$\mathcal{H}$は可分であるという．
(本来は位相空間での話だが，このスライドではヒルベルト空間での文脈を重視．)

**[Def]** 稠密
ノルム空間$X$の2つの部分集合$S_1，S_2$に対して，それらの閉包$\overline{S_1}，\overline{S_2}$が$\overline{S_1} \supseteq \overline{S_2}$の関係を満たすとき，$S_1$は$S_2$で稠密という．
$\overline{S}=X$が成立するとき，$S$は$X$で稠密であるという．

---
## 書評（個人の感想です）

- [「集合と位相」をなぜ学ぶのか ― 数学の基礎として根づくまでの歴史　(藤田博司)][fujita]
  - 数学史の本．一般の人向け．学部1年生のときになぜ集合と位相から学び始めるのかがわかる．モチベーションがあがるし，全然難しくないのでめちゃくちゃオススメ．1800年～の数学において，その時代における何の問題を解決したいがためにある概念が考案されたのかのストーリーが楽しい．フーリエ級数から話が始まる．
- [固有値問題30講　(志賀浩二)][shiga1]
  - 行列の数学としての線形代数から抽象的な線形代数の橋渡しになる．ヒルベルト空間の理論体系がなぜ組み上がったのかの話がのっており，オススメ．
---
## 書評（個人の感想です）
- [ルベーグ積分30講　(志賀浩二)][shiga2]
  - 理学系以外の人がルベーグ積分を始めるときにはここから読み始めるのがベストだとおもう．とてもとてもオススメ．読者に寄り添っている．京大博士にルベーグ積分学びたいんだけど一番最初に読むならどれ？と聞いたらこの本とコルモゴロフの本をあげてくれた．コルモゴロフは敷居が高い…

- [測度・確率・ルベーグ積分　応用への最短コース　(原啓介)][hara]
  - 一度ルベーグ積分を概観した人が，見直しとして読むには良いと思うおそらく．短くまとまっている．測度やルベーグ積分という単語をはじめて知った人が読むと，法則や話が天から降ってくるような感じがする．

---
## 書評（個人の感想です）
- [工学のための関数解析　(山田功)][yamada]
  - 工学系の人間が，応用も視野にいれつつ，関数解析の話題についていけるように配慮されている．著者が信号処理，データサイエンス系の人なので，話題に親近感がわく．見た目がきれい．例がたくさんでわかりやすいと人気だが，最初にとりくんだときには定義も定理も例もはいってこなかった．雑魚かった．
- [工学系の関数解析　(小川英光)][ogawa]
  - 上と名前が似ている．証明の行間がほとんど無くとてもオススメ．この本の内容を参考にスライドを作成した．数学者が書いた数学書を読めない雑魚に優しい．

---
## 参考資料いあげなかった本の書評（個人の感想です）
- [実解析入門 (猪狩惺)][igari]
  - どんな話題も載っている．$\mathbb{R}^d$上の測度・ルベーグ積分から一般の集合上の測度・ルベーグ積分への展開の見通しが良い．極めて丁寧に説明されている．学がなく章の終わりの方の話題にまったくついていけない．
  - 自分はまだ著者が想定したこの本の読者のレベルにない．
- [ルベーグ積分論　(柴田良弘)][shibata]
  - 本当に本当に丁寧にルベーグ積分の導入をしてくれる．「全ての定理に厳密な証明をつけている」との書籍の宣伝文句は伊達ではない．証明の行間がまじで本当にまったくない．一歩一歩進みたい人に．
  - 自分はまだ著者が想定したこの本の読者のレベルにない．
- [関数解析　(黒田成俊)][kuroda]
  - 自分はまだ著者が想定したこの本の読者のレベルにない．

[igari]:https://www.iwanami.co.jp/book/b440457.html
[shibata]:http://www.rokakuho.co.jp/data/books/0070.html
[kuroda]:https://www.kyoritsu-pub.co.jp/bookdetail/9784320011069


